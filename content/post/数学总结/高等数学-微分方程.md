---
title: "高等数学-微分方程"
date: 2020-11-25T05:24:48+08:00
draft: false
categories: ["数学"]
tags: ["高等数学", "微分方程"] 
markup: pandoc
math: true
---

# 高等数学-微分方程

许多问题中，往往不能直接给出所需要的函数关系，看是根据问题所提供的情况，有时可以列出含有要找的函数及其导数的关系式。这样的关系式就是**微分方程**。

微分方程建立后，对它进行研究，找出未知函数来，这就是**解微分方程**。

## 微分方程的基本概念

##### 微分方程

**微分方程**：含有自变量、未知函数以及未知函数导数或微分的方程。

**常微分方程**：未知函数是一元函数的微分方程。

常微分方程**一般形式**：$F\left(x, y, y^{\prime}, \cdots * y^{(n)}\right)=0$

常微分方程**标准形式**（可解出最高阶导数）：$y^{(n)}=f\left(x, y, y^{\prime}, \cdots, y^{(n-1)}\right)$

**微分方程的阶**：微分方程中所出现的未知函数的最高阶导数的阶数。

**微分方程的解**：建立微分方程后，找出满足微分方程的函数，这个函数代入微分方程能使该方程成为恒等式，这个函数就叫做微分方程的解。

**微分方程的通解**：如果微分方程的解中含有任意常数，且任意常数的个数与微分方程的阶数相同，这样的解叫做微分方程的通解。

**微分方程的初值条件**（定解条件）：根据实际情况给定的条件，用来确定微分方程的通解中的任意常数。

**微分方程的特解**：确定了通解中的任意常数后，就得到了微分方程的特解。

微分方程的积分曲线：微分方程的解$y=y(x)$所表示的曲线。

## 一阶微分方程$y^{\prime}=f(x, y)$及解法

一阶微分方程标准形式$\frac{dy}{dx} = P(x,y)$

**利用变量代换**（因变量的变量代换或者自变量的变量代换）把一个**微分方程化为变量可分离的方程**，或者**化为已知求解步骤的方程**，这是解微分方程最常用的方法。

**一阶微分方程中，可解的方程**有：
可分离变量的微分方程、
齐次微分方程、
线性微分方程、
非线性微分方程中的伯努利方程

一阶的微分方程中，**一般的非线性微分方程不可解**。

### 可分离变量的一阶微分方程

可分离变量的一阶微分方程：某些一阶微分方程可以化成即微分方程一端只含x和$dx$，另一端只含y和$dy$

的形式。如$\frac{dy}{dx} = P(x)Q(y)$，或者$g(y) \mathrm{d} y=f(x) \mathrm{d} x$。

对于可分离变量的一阶微分方程，分离变量后，两边取积分即可求得原方程得通解。

分离变量法是求解微分方程的根本方法。

### 一阶[x与y齐次]微分方程

注：请注意微分方程中[齐次的不同意义](#附：齐次的辨析)

#### 齐次方程

如果一阶微分方程可以写成$\frac{\mathrm{d} y}{\mathrm{d} x}=\varphi\left(\frac{y}{x}\right)$，是x与y齐次的一阶微分方程，简称**齐次方程**。

求**解x与y齐次的一阶微分方程，方法是作变量代换$u=\frac{y}{x}$，**则$y=ux, \frac{dy}{dx}=x \frac{du}{dx} + u$。
代入原方程得$u+x \frac{\mathrm{d} u}{\mathrm{d} x}=\varphi(u)$。
这是一个可分离变量的一阶微分方程，分离变量得 $\frac{\mathrm{d} u}{\varphi(u)-u}=\frac{\mathrm{d} x}{x}$，两边取积分可求得原方程通解。

#### 可化为齐次的方程

1）对于方程$\frac{\mathrm{d} Y}{\mathrm{d} X}=\frac{a X+b Y}{a_{1} X+b_{1} Y}$，自然可化为齐次方程。

2）对于方程$\frac{\mathrm{d} y}{\mathrm{d} x}=\frac{a x+b y+c}{a_{1} x+b_{1} y+c_{1}}$，作变量代换$x=X+h, \quad y=Y+k$，
方程变为$\frac{\mathrm{d} Y}{\mathrm{d} X}=\frac{a X+b Y+a h+b k+c}{a_{1} X+b_{1} Y+a_{1} h+b_{1} k+c_{1}}$，
令$\left\{\begin{array}{l}a h+b k+c=0 \\ a_{1} h+b_{1} k+c_{1}=0\end{array}\right.$，可解出h和k，同时方程可化为齐次方程。

3）对于方程$\frac{\mathrm{d} y}{\mathrm{d} x}=f\left(\frac{a x+b y+c}{a_{1} x+b_{1} y+c_{1}}\right)$，类似的，也可以化为齐次方程。

### 解一阶线性微分方程

一阶线性微分方程：$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$。它对于未知函数y和其1阶导数导数都是1次。

线性：（数乘+加法）性质

[线性方程组：线性的说明：维基百科](https://zh.wikipedia.org/wiki/%E7%BA%BF%E6%80%A7%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B)

注意：像$y^{\prime}+y \tan x=\cos x$这样的微分方程，也是一阶线性微分方程。

#### 解一阶[y和y‘齐次]线性微分方程：分离变数法

一阶线性微分方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$，当$Q(x)=0$时，即$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=0$时，称为一阶（y和y的导数齐次）线性微分方程，简称**齐次线性方程**

**求解**：齐次线性方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=0$可用**分离变数法**求得**齐次线性方程的通解**$y=C \mathrm{e}^{-\int P(x) \mathrm{d} x}$。

#### 解一阶[y和y’非齐次]线性微分方程：常数变易法

一阶线性微分方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$，当$Q(x) \neq 0$时，称为一阶（y和y‘非齐次）线性微分方程，简称一阶**非齐次线性方程**
(注：这里除了齐次的y和y'项，还有自由项$Q(x)$存在，所以非齐次)

**求解**：求解一阶非齐次线性微分方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$的方法是**常数变易法**：
首先，其对应的一阶齐次线性微分方程的通解$y=C \mathrm{e}^{-\int P(x) \mathrm{d} x}$，将其中的常数C替换为x的函数$u(x)$，即$y=u(x) \mathrm{e}^{-\int P(x) \mathrm{d} x}$，作为非齐次线性微分方程的解。
将其代入非齐次线性方程，解得$u=\int Q(x) \mathrm{e}^{\int P(x) \mathrm{d} x} \mathrm{d} x+C$。
从而解得**非齐次线性方程的通解**$y=\mathrm{e}^{-\int P(x) \mathrm{d} x}\left(\int Q(x) \mathrm{e}^{\int P(x) \mathrm{d} x} \mathrm{d} x+C\right)$
此通解也可以**看作齐次线性方程的通解和非齐次方程一个特解之和**$y=C \mathrm{e}^{-\int P(x) d x}+ \left[\int Q(x) \mathrm{e}^{\int P(x) d x} \mathrm{d} x \right]  \mathrm{e}^{-\int P(x) \mathrm{d} x} $

（关于常数变易法的更多讨论，参见：[解非齐次线性微分方程：常数变易法](#非齐次线性微分方程的求解（已知齐次通解）：常数变易法)

### 伯努利方程

伯努利方程：$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x) y^{n} \quad(n \neq 0,1)$

当$n=0$或$n=1$时，为线性微分方程。

当$n \neq 0 , n \neq 1$时，为伯努利方程，这个是**非线性方程**。

通过变量代换，可以化为线性方程求解：
以$y^n$除方程两端，得：$y^{-n} \frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y^{1-n}=Q(x)$
得：$\frac{1}{1-n}\frac{\mathrm{d}}{\mathrm{d} x}\left(y^{1-n}\right)+P(x) y^{1-n}=Q(x)$	
令$z=y^{1-n}$，得：$\frac{\mathrm{d} z}{\mathrm{d} x}+(1-n) P(x) z=(1-n) Q(x)$
上式是个一阶线性微分方程，根据前一节给出的方法可以求其通解。
以$y^{1-n}$代z即伯努利方程的通解。

## 可降至一阶的高阶微分方程及解法

**高阶微分方程**：二阶及二阶以上的微分方程。

对于**有些高阶微分方程，可以通过代换将它化成较低阶的方程来求解**。

### $y^{(n)}=f(x)$型微分方程

**变量代换**：如果**把$y^{(n-1)}$看作未知函数**，则微分方程就是该函数的一阶可分离变量微分方程。

**求解方法**：两边分别对$y$和$x$积分，重复多次即可。

注意：每积分一次，产生一个不相关的常数。

### $y^{\prime \prime}=f\left(x, y^{\prime}\right)$型微分方程

$y^{\prime \prime}=f\left(x, y^{\prime}\right)$，方程右端不显含y。

**变量代换与求解**：将$y'$看作未知函数p，即$y^{\prime}=p$，
同时有$y^{\prime \prime}=\frac{\mathrm{d} p}{\mathrm{d} x}=p^{\prime}$，
则方程化为一阶微分方程$p^{\prime}=f(x, p)$
假如解出p的通解$p=\varphi\left(x, C_{1}\right)$，即$\frac{\mathrm{d} y}{\mathrm{d} x}=\varphi\left(x, C_{1}\right)$，这又是一个可分离变量的一阶微分方程，继续求解可得y的通解

### $y^{\prime \prime}=f\left(y, y^{\prime}\right)$型微分方程

$y^{\prime \prime}=f\left(y, y^{\prime}\right)$，方程右端不显含x。

**变量代换与求解**：将$y'$看作未知函数p，即$y^{\prime}=p$，
由复合函数求导法则有$y^{\prime \prime}=\frac{\mathrm{d} p}{\mathrm{d} x}=\frac{\mathrm{d} p}{\mathrm{d} y} \cdot \frac{\mathrm{d} y}{\mathrm{d} x}=p \frac{\mathrm{d} p}{\mathrm{d} y}$，
原方程变为$p \frac{\mathrm{d} p}{\mathrm{d} y}=f(y, p)$，
即$\frac{\mathrm{d} p}{\mathrm{d} y}=\frac {f(y, p)}{p}$，这是关于y，p为变量的一阶微分方程。
设此一阶方程可解，且其通解为$y^{\prime}=p=\varphi\left(y, C_{1}\right)$，
分离变量并积分，可得最初方程的通解。

## 线性微分方程

高阶线性方程在实际应用较多。
如有空气阻尼弹簧振子自由振动的微分方程$\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}}+2 n \frac{\mathrm{d} x}{\mathrm{d} t}+k^{2} x=0$，
如弹簧振子受迫振动的微分方程$\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}}+2 n \frac{\mathrm{d} x}{\mathrm{d} t}+k^{2} x=h \sin p t$
带交流电源串联LC电路震荡方程$\frac{\mathrm{d}^{2} x}{\mathrm{d} t^{2}}+2 n \frac{\mathrm{d} x}{\mathrm{d} t}+k^{2} x=h \sin p t$
充电后撤电源串联LC电路震荡方程$\frac{\mathrm{d}^{2} u_{C}}{\mathrm{d} t^{2}}+2 \beta \frac{\mathrm{d} u_{C}}{\mathrm{d} t}+\omega_{0}^{2} u_{c}=0$
(推导过程见：同济高数：第七版（上册）高阶线性微分方程章节)

### 线性微分方程的形式

#### 一阶线性微分方程

一阶线性微分方程：$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$。它对于未知函数y和其1阶导数导数都是1次。

前面已经讨论过一阶线性微分方程，分离变数法可以求解对应的一阶齐次线性微分方程，常数变易法可以求解一阶非齐次线性微分方程。下面不多做赘述。

#### 二阶线性微分方程

二阶线性微分方程：$\frac{\mathrm{d}^{2} y}{\mathrm{d} x^{2}}+P(x) \frac{\mathrm{d} y}{\mathrm{d} x}+Q(x) y=f(x)$。它对于y及y的各阶导都是一次的，具有线性特征（数乘、加法）

##### 二阶[y、y'、y‘’齐次]线性微分方程

当二阶线性微分方程$\frac{\mathrm{d}^{2} y}{\mathrm{d} x^{2}}+P(x) \frac{\mathrm{d} y}{\mathrm{d} x}+Q(x) y=f(x)$取$f(x)=0$时，
即$\frac{\mathrm{d}^{2} y}{\mathrm{d} x^{2}}+P(x) \frac{\mathrm{d} y}{\mathrm{d} x}+Q(x) y=0$，称为二阶[y、y'、y‘’齐次]线性微分方程，简称**二阶齐次线性微分方程**

(关于“齐次”的讨论与辨析，请参考[附：齐次的辨析](#附：齐次的辨析))

###### 二阶常系数齐次线性微分方程

如果二阶齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=0$中，如果 $y^{\prime}, y$ 的系数 $P(x), Q(x)$ 均为常数,
即$y^{\prime \prime}+p y^{\prime}+q y=0$，其中 $p, q$ 是常数，称为二阶常系数齐次线性微分方程。

二阶常系数齐次线性微分方程是可以解出来的，并可以总结为公式。详见[后面的章节](#常系数齐次线性微分方程的求解)

##### 二阶[y、y'、y‘’非齐次]线性微分方程

当二阶线性微分方程$\frac{\mathrm{d}^{2} y}{\mathrm{d} x^{2}}+P(x) \frac{\mathrm{d} y}{\mathrm{d} x}+Q(x) y=f(x)$取$f(x) \neq 0$时，称为二阶[y、y'、y‘’非齐次]线性微分方程，简称**二阶非齐次线性微分方程**

###### 二阶常系数非齐次线性微分方程

类似的，如果二阶非齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)$中，如果 $y^{\prime}, y$ 的系数 $P(x), Q(x)$ 均为常数,
即$y^{\prime \prime}+p y^{\prime}+q y=f(x)$，其中 $p, q$ 是常数，称为二阶常系数非齐次线性微分方程。

二阶常系数非齐次线性微分方程是可以解出来的，并可以总结为公式。详见[后面的章节](#常系数齐次线性微分方程的求解)

#### n阶线性微分方程

n阶线性微分方程：$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$

二阶线性微分方程解的性质，可以推广导n阶线性微分方程

##### n阶常系数齐次线性微分方程

类似于二阶，有n阶常系数齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=0$，其中 $p_{1}, p_{2}, \cdots, p_{n-1}, p_{n}$ 都是常数.

二阶常系数齐次线性微分方程也可以总结为公式。详见[后面的章节](#常系数齐次线性微分方程的求解)

##### n阶常系数非齐次线性微分方程

以及有n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=f(x)$，其中 $p_{1}, p_{2}, \cdots, p_{n-1}, p_{n}$ 都是常数.

n阶常系数非齐次线性微分方程也可以总结为公式。详见[后面的章节](#常系数齐次线性微分方程的求解)

### 线性微分方程解的性质与结构

##### 二阶与更高阶齐次线性微分方程解的叠加原理

如果函数 $y_{1}(x)$ 与 $y_{2}(x)$ 是二阶齐次线性方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=0$的两个解,
那么$y=C_{1} y_{1}(x)+C_{2} y_{2}(x)$也是这个方程的解，其中$C_1,C_2$是任意常数

（证明：将y代入即可）

（同理可证，n阶齐次线性微分方程的解，都满足叠加原理）

##### 二阶或更高阶齐次线性微分方程解的结构

如果函数 $y_{1}(x)$ 与 $y_{2}(x)$ 是二阶齐次线性方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=0$的**线性无关的两个特解**,
那么$y=C_{1} y_{1}(x)+C_{2} y_{2}(x)$是这个方程的通解，其中$C_1,C_2$是任意常数

（[函数的线性相关与线性无关](#附2：线性相关与线性无关)的说明）

（证明：根据齐次方程解的叠加原理，y是这个齐次方程的解；y中常数个数等于方程阶数，所以是方程的通解）

（同理可证，n阶齐次线性微分方程解的结构，也有类似二阶的结论）

##### 二阶或更高阶非齐次线性微分方程解的叠加原理

设$y_{1}^{*}(x)$ 与 $y_{2}^{*}(x)$ 分别是方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f_{1}(x)$与$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f_{2}(x)$的特解，
则$y_{1}^{*}(x)+y_{2}^{*}(x)$是$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f_{1}(x)+f_{2}(x)$的特解。

（证明：代入即可证明）

（同理可证，n阶非齐次线性微分方程，也满足叠加原理）

##### 二阶或更高阶非齐次线性微分方程解的结构

设 $y^{*}(x)$ 是二阶非齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)$的一个特解，
$Y(x)$ 是与 之对应的齐次方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=0$通解,
则$y=Y(x)+y^{*}(x)$是非齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)$的通解。

（证明：将y代入微分方程即可）

（同理可证，n阶非齐次线性微分方程，解的结构也有类似二阶的结论）

### 非齐次线性微分方程的求解（已知齐次通解）：常数变易法

（常数变易法解非齐次线性微分方程的**前提是，已经求出对应齐次线性微分方程的通解**。）
（但是遗憾的是，除了常系数齐次线性微分方程，大部分的变系数齐次线性微分方程都求不出通解）

根据齐次线性微分方程的通解，将**齐次解的常数$C_i$替换为x的函数$C_i(x)$作为非齐次的解**，可以解出对应的非齐线性微分方程，这种方法叫**常数变易法**，又称拉格朗日法。

参考：高等数学同济第七版（上）
参考：知乎：https://www.zhihu.com/question/31329122
参考：知乎：https://www.zhihu.com/question/41042058



#### 解一阶[y与y'非齐次]线性微分方程：常数变易法

对于非齐次线性方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x)$的求解，可以用**常数变易法**：
对应的一阶齐次线性方程$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=0$的通解（已知）为$y=C y_1 = C \mathrm{e}^{-\int P(x) \mathrm{d} x}$，
则设对应非齐次的解为$y=u y_1 = u \mathrm{e}^{-\int P(x) \mathrm{d} x}$ ，（将齐次解的常数C替换为x的函数$u(x)$作为非齐次的解，为什么可以这样做？后面一节提供了[几种思路](#常数变易法的思路)），
将非齐次的解y代入非齐次线性方程，可解得$u=\int Q(x) \mathrm{e}^{\int P(x) \mathrm{d} x} \mathrm{d} x+C$。
从而解得一阶非齐次线性方程的通解$y=\mathrm{e}^{-\int P(x) \mathrm{d} x}\left(\int Q(x) \mathrm{e}^{\int P(x) \mathrm{d} x} \mathrm{d} x+C\right)$
此通解也可以看作齐次线性方程的通解和非齐次方程一个特解之和$y=C \mathrm{e}^{-\int P(x) d x}+ \left[\int Q(x) \mathrm{e}^{\int P(x) d x} \mathrm{d} x \right]  \mathrm{e}^{-\int P(x) \mathrm{d} x} $

#### 常数变易法的思路

分离变量是解微分方程最基础也是最根本的方法。

常数变易法可以看作是是分离变量的过程中产生的固定方法。

##### 常数变易法的思路一

![img](https://picgo12138.oss-cn-hangzhou.aliyuncs.com/md/v2-f5daa318393e2d317136b1cf4426eb76_720w.jpg)

##### 常数变易法思路二

参考：东曦.知乎.链接：https://www.zhihu.com/question/31329122/answer/134977454

一切的一切，都来源于这个小贱人：![[公式]](https://www.zhihu.com/equation?tex=\frac{dy}{dx}%2BP(x)·y%3DQ(x)+),让你求y函数的表达式。

直白的说，因为有P（x）和Q（x）在那里摆着，首先这个等式不一定齐次。即使齐次，只要Q（x）不等于0，就无法分离变量。

而我们知道，**变量分离是最根本的解法**，俗称“万变不离其宗”。那完，这个没法分离变量。

于是大佬跟它斗争了十一年，最后发现设![[公式]](https://www.zhihu.com/equation?tex=y%3DU(x)·V(x))是可以的.（下面简写为![[公式]](https://www.zhihu.com/equation?tex=y%3Du·v)）

哦当然当时设的时候他并不知道这样是可以的。总之大佬抱着试一试的心理代入了原式，得到![[公式]](https://www.zhihu.com/equation?tex=\frac{du}{dx}·v%2Bu(\frac{dv}{dx}%2BP(x)v)%3DQ(x)++).

大佬不忘初心，始终坚持着变量分离的思想。“我要分离u和x！”（好吧是我有点中二QAQ）

在这里插一句，为什么不是分离v和x呢？其实在这里v和u是完全对等的状态，可以说只是符号表示的不同，不信把上式中的v提出来，你会发现形式完全相同。

回到正题…大佬想要分离u和x。乍一眼看，要是令![[公式]](https://www.zhihu.com/equation?tex=\frac{dv}{dx}%2BP(x)v+)
等于零，那么![[公式]](https://www.zhihu.com/equation?tex=u(\frac{dv}{dx}%2BP(x)v)+)一整项就不见了，能求出一个只跟随P（x）变化的函数v，再把v代进![[公式]](https://www.zhihu.com/equation?tex=\frac{du}{dx}v%3DQ(x)+)，积个分，u不就也出来了么。u和v都能用P（x）、Q（x）表示了，y也就出来了。

按这个思路一路畅快地推导下来，得到![[公式]](https://www.zhihu.com/equation?tex=v%3DC_{1}++e^{\int_{}-P(x)dx+}+),![[公式]](https://www.zhihu.com/equation?tex=u%3D\frac{1}{C_{1}+}+\int_{}^{}Q(x)e^{\int_{}^{}P(x)dx+}dx%2BC_{2}+)。一路愉快地求出y。

其实到这里这道题就结束了，结论也可以随便用了。但是！（敲黑板）因为v是跟随P（x）改变而改变的，对每一个确切的一阶线性方程都只存在唯一的一个v，再根据以上的推导过程可以知道对每一个确切的一阶线性方程也只存在唯一的一个u，所以大佬决定省略以上推导过程，就不设![[公式]](https://www.zhihu.com/equation?tex=y%3Duv)，而是直接设![[公式]](https://www.zhihu.com/equation?tex=y%3Due^{\int_{}^{}-P(x)dx+}+)，来求下面的过程。这就是常数变易法。

问：我有个疑问：这个公式有个前提(dv/dx)+p(x)v＝0，等于0是一个特殊情况，如果不等于0呢？

答：这个式子不是前提，**是其中一个解**。0是最容易让人想到从这方面入手的特殊数字，所以拉格朗日试着让它等于0，然后发现确实能解出来。于是这个式子就诞生了。
也许不等于0的时候也有某个解存在呢？但是这还没人做出来。

##### 常数变易法的思路三

参考：fjh1997.知乎.链接：https://www.zhihu.com/question/31329122/answer/663336777

首先我们要求解如下式子：

![[公式]](https://www.zhihu.com/equation?tex=y'%2Bp(x)y%3Dq(x))

那么可以看出，左边的式子和乘法求导公式有点像，我们可以把式子两边同乘以 ![[公式]](https://www.zhihu.com/equation?tex=u(x)) ,在这里，我们把 ![[公式]](https://www.zhihu.com/equation?tex=u) 叫做积分因子，可以得到：

![[公式]](https://www.zhihu.com/equation?tex=y'u%2Bpuy%3Dqu)

这个时候的思路就很简单，我们要是把左边的式子凑成关于x的某个函数的导数，然后两边积分，岂不是就很容易求解了？让我们试试吧。首先猜测是 ![[公式]](https://www.zhihu.com/equation?tex=(yu)') ，那么：

![[公式]](https://www.zhihu.com/equation?tex=(yu)'%3Dy'u%2Bu'y)

这样，我们只要找到一个 ![[公式]](https://www.zhihu.com/equation?tex=u) ,使得 ![[公式]](https://www.zhihu.com/equation?tex=u'%3Dpu) ，那么不就解出来了？

假如找到这样的u，满足 ![[公式]](https://www.zhihu.com/equation?tex=(yu)'%3Dqu)

那么可以得到 ![[公式]](https://www.zhihu.com/equation?tex=y%3D\frac+{\int+qu%2BC}u)          ①

就完成了求解

那么，接下来

让我们解 ![[公式]](https://www.zhihu.com/equation?tex=u'%3Dpu) 吧

![[公式]](https://www.zhihu.com/equation?tex=\frac+{du}{dx}%3Dp(x)u)

整理得

![[公式]](https://www.zhihu.com/equation?tex=\frac+{du}{u}%3Dp(x)dx)

两边积分得

![[公式]](https://www.zhihu.com/equation?tex=lnu%3D\int+p(x)dx)

故 ![[公式]](https://www.zhihu.com/equation?tex=u%3De^{\int+pdx})

要注意的是，以上不定积分只要求出一个满足条件的 ![[公式]](https://www.zhihu.com/equation?tex=u) 即可，不用全部求出来(因为题目是让你求y,不是求u，u只是辅助而已)

求得 ![[公式]](https://www.zhihu.com/equation?tex=u) 之后带入①式子就已经可以解出 ![[公式]](https://www.zhihu.com/equation?tex=y) 了,这样非常简单，我们把 ![[公式]](https://www.zhihu.com/equation?tex=u) 带入①来得到同济版的公式吧~

![[公式]](https://www.zhihu.com/equation?tex=y%3D\frac+{\int+qudx%2BC}u%3D\frac+{\int+qe^{\int+pdx}dx%2BC}{e^{\int+pdx}}%3D+e^{-\int+pdx}\int+qe^{\int+pdx}dx%2Be^{-^{\int+pdx}}C)

#### 解二阶非齐次线性微分方程：常数变易法

##### 已知齐次通解，求解二阶非齐次线性微分方程：常数变易法

如果已知对应的二阶齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=0$的通解为$Y(x)=C_{1} y_{1}(x)+C_{2} y_{2}(x)$，
令$y=y_{1}(x) v_{1}+y_{2}(x) v_{2}$，要确定函数 $v_{1}(x)$ 及 $v_{2}(x)$ 使y满足对应的非齐次线性微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)$。

而为了将$y=y_{1}(x) v_{1}+y_{2}(x) v_{2}$代入非齐次线性微分方程，我们要求出y的各阶导。
$y^{\prime}=y_{1} v_{1}^{\prime}+y_{2} v_{2}^{\prime}+y_{1}^{\prime} v_{1}+y_{2}^{\prime} v_{2}$
当/令$y_{1} v_{1}^{\prime}+y_{2} v_{2}^{\prime}=0$ 时（**我们添加的限制条件**，简化计算为宜），$y^{\prime \prime}=y_{1}^{\prime} v_{1}^{\prime}+y_{2}^{\prime} v_{2}^{\prime}+y_{1}^{\prime \prime} v_{1}+y_{2}^{\prime \prime} v_{2}$，
然后可将$y,y', y''$代入非齐次线性微分方程，得$y_{1}^{\prime} v_{1}^{\prime}+y_{2}^{\prime} v_{2}^{\prime}=f(x)$
**注意**：添加限制条件$y_{1} v_{1}^{\prime}+y_{2} v_{2}^{\prime}=0$ 时，如果非齐次线性微分方程**有解的话**，所对应的y仍是该方程**解的一种情况**（一个特解）
现在我们已知：$\left\{ \begin{array}{l} y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)\\y=y_{1}(x) v_{1}+y_{2}(x) v_{2} \\ y_1 = y_1(x) \quad\text{(已知具体函数形式)}\\ y_2 = y_2(x) \quad\text{(已知具体函数形式)}\\ y_{1} v_{1}^{\prime}+y_{2} v_{2}^{\prime}=0 \quad \text{(我们添加的限制条件)} \end{array} \right.$
6个变量$y,y_1,y_2,v_1,v_2,x$，5个限制条件，则有1个自由元x，我们可以从中解出$v_1,v_2$以及y.
消元，即求解$\left\{ \begin{array}{l} y_{1}^{\prime} v_{1}^{\prime}+y_{2}^{\prime} v_{2}^{\prime}=f(x)\\ y_{1} v_{1}^{\prime}+y_{2} v_{2}^{\prime}=0 \quad \text{(我们添加的限制条件)} \end{array} \right.$
即求解以$v_1,v_2$为变量的函数矩阵：
$\left[\begin{array}{ll}y_{1} & y_{2} \\ y_{1}^{\prime} & y_{2}^{\prime}\end{array}\right]\left[\begin{array}{l}v_{1}^{\prime} \\ v_{2}^{\prime}\end{array}\right]=\left[\begin{array}{l}0 \\ 1\end{array}\right] f(x)$
在系数行列式$W=\left|\begin{array}{ll}y_{1} & y_{2} \\ y_{1}^{\prime} & y_{2}^{\prime}\end{array}\right|=y_{1} y_{2}^{\prime}-y_{1}^{\prime} y_{2} \neq 0$时，
解得$v_{1}^{\prime}=-\frac{y_{2} f}{W}, v_{2}^{\prime}=\frac{y_{1} f}{W}$，
积分得$v_{1}=C_{1}+\int\left(-\frac{y_{2} f}{W}\right) \mathrm{d} x, v_{2}=C_{2}+\int \frac{y_{1} f}{W} \mathrm{d} x$，
于是得非齐次微分方程$y^{\prime \prime}+P(x) y^{\prime}+Q(x) y=f(x)$的通解$y=C_{1} y_{1}+C_{2} y_{2}-y_{1} \int \frac{y_{2} f}{W} \mathrm{d} x+y_{2} \int \frac{y_{1} f}{W} \mathrm{d} x$

##### 已知齐次的一个特解，求解二阶非齐次线性微分方程：常数变易法

对于已知二阶非齐次线性微分方程对应的齐次线性微分方程的一个特解$y_1$（不恒为0）的情况：

如果已知二阶非齐次线性微分方程对应的齐次线性微分方程的一个特解$y_1$, **也可以使用常数变易法**，设$y=u(x) \cdot y_1(x)$为二阶非齐次线性微分方程的解，代入非齐次方程，可化为一阶非齐次线性微分方程，进而求解。

#### 解n阶非齐次线性微分方程：常数变易法

一阶、二阶线性微分方程的常数变易法（即利用对应齐次方程的通解，代换其中常数求非齐次线性方程通解的方法），可以推广到n线性微分方程。

对于n阶非齐次线性微分方程：$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$

假设我们求得的对应的n阶齐次线性微分方程$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=0$的通解为$y=C_1 y_1 + C_2 y_2 + ... + C_n y_n$
常数变易法（把齐次解中的**常数换为未知函数**作为非齐次的解）：
**设**对应的n阶**非齐次**线性微分方程：$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$的**通解为**$y=C_1(x) y_1 + C_2(x) y_2 + ... + C_n(x) y_n$  (不用太在意为什么要这么设，如果带进去有解，那么就是正确的；非要细纠的话，参考一阶非齐次线性微分方程的常数变易法的几种思路)
为了将y代入非齐次线性微分方程，我们需要求出y的各阶导：
$\begin{aligned} y^{\prime}=& C_{1}(x) y_{1}^{\prime}+C_{2}(x) y_{2}^{\prime}+\cdots+C_{n}(x) y_{n}^{\prime} \\ &+C_{1}^{\prime}(x) y_{1}+C_{2}^{\prime}(x) y_{2}+\cdots+C_{n}^{\prime}(x) y_{n} \end{aligned}$
**设**$C_{1}^{\prime}(x) y_{1}+C_{2}^{\prime}(x) y_{2}+\cdots+C_{n}^{\prime}(x) y_{n}=0$，则$y^{\prime}=C_{1}(x) y_{1}^{\prime}+C_{2}(x) y_{2}^{\prime}+\cdots+C_{n}(x) y_{n}^{\prime}$（不用介意这里新设了约束条件，只要最后有解，所用的y依旧是非齐次线性微分方程的一个解）
**设**$C_{1}^{\prime}(x) y_{1}^{\prime}+C_{2}^{\prime}(x) y_{2}^{\prime}+\cdots+C_{n}^{\prime}(x) y_{n}^{\prime}=0$，则$y^{\prime \prime}=C_{1}(x) y_{1}^{\prime \prime}+C_{2}(x) y_{2}^{\prime \prime}+\cdots+C_{n}(x) y_{n}^{\prime \prime}$（又增设了约束条件，只为了y的导数形式更简单）
...
**设**$C_{1}^{\prime}(x) y_{1}^{(n-2)}+C_{2}^{\prime}(x) y_{1}^{(n-2)}+\cdots+C_{n}^{\prime}(x) y_{1}^{(n-2)}=0$，则$y^{(n-1)}=C_{1}(x) y_{1}^{(n-1)}+C_{2}(x) y_{1}^{(n-1)}+\cdots+C_{n}(x) y_{1}^{(n-1)}$（又增设了约束条件，只为了y的导数形式更简单）
直接再求一次导得
$\begin{aligned} y^{(n)}=& C_{1}(x) y_{1}^{(n)}+C_{2}(x) y_{2}^{(n)}+\cdots+C_{n}(x) y_{n}^{(n)} \\ &+C_{1}(x) y_{1}^{(n-1)}+C_{2}^{\prime}(x) y_{2}^{(n-1)}+\cdots+C_{n}^{\prime}(x) y_{n}^{(n-1)} \end{aligned}$
将各阶导代入非齐次线性微分方程$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$得$C_{1}^{\prime}(x) y_{1}^{(n-1)}+C_{2}^{\prime}(x) y_{1}^{(n-1)}+\cdots+C_{n}^{\prime}(x) y_{1}^{(n-1)}=f(x)$
综合**新设的约束条件**和**各阶导代入非齐次线性微分方程的结果**可得方程组：
$\left[\begin{array}{cccc}y_{1}(x) & y_{2}(x) & \cdots & y_{n}(x) \\ y_{1}^{\prime}(x) & y_{2}^{\prime}(x) & \cdots & y_{n}^{\prime}(x) \\ \vdots & \vdots & & \vdots \\ y_{1}^{(n-1)}(x) & y_{2}^{(n-1)}(x) & \cdots & y_{n}^{(n-1)}(x)\end{array}\right]\left[\begin{array}{c}C_{1}^{\prime}(x) \\ C_{2}^{\prime}(x) \\ \vdots \\ C_{n}^{\prime}(x)\end{array}\right]=\left[\begin{array}{c}0 \\ \vdots \\ 0 \\ 1\end{array}\right] f(x)$
它是关于变量 $C_{i}^{\prime}(x)(i=1,2, \cdots, n)$ 的线性代数方程组，它的系数行列式恰好是对应齐次方程组n个线性无关解的朗斯基行列式，它恒不为0，所以上述方程组关于变量 $C_{i}^{\prime}(x)(i=1,2, \cdots, n)$ 有唯一解。
解出 $C_{i}^{\prime}(x)(i=1,2, \cdots, n)$ 再积分，便可得到n阶非齐次线性微分方程$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$的通解（按以上求解步骤应该是特解，但是解中常数个数正好等于阶数n，所以是通解）



### 常系数线性微分方程的求解

#### 常系数齐次线性微分方程的求解：特征方程法

##### 二阶常系数齐次线性微分方程的求解：特征方程法

$y^{\prime \prime}+p y^{\prime}+q y=0$，其中 $p, q$ 是常数，称为二阶常系数齐次线性微分方程。

由[二阶齐次线性微分方程的解的结构](#二阶或更高阶齐次线性微分方程解的结构)知，找到其两个线性无关的解$y_1,y_2$，则$y=C_{1} y_{1}+C_{2} y_{2}$就是方程的通解

注意到$y^{\prime \prime}+p y^{\prime}+q y=0$中y, y', y''是线性相关的（不严谨的说，可以用几个常数互相表示，也就是差了几个常数）。又注意到指数函数$y=\mathrm{e}^{r x}$与其各阶导数只差了一个常数（可以互相表示，线性相关）。于是我们考虑用$y=\mathrm{e}^{r x}$试解$y^{\prime \prime}+p y^{\prime}+q y=0$
**将$y=\mathrm{e}^{r x}$代入二阶常系数齐次线性微分方程，如果存在r使方程成立，则$y=\mathrm{e}^{r x}$就是方程的一个解**。

$y=\mathrm{e}^{r x}$，$y^{\prime}=r \mathrm{e}^{r x}, \quad y^{\prime \prime}=r^{2} \mathrm{e}^{r x}$（r是负数也成立）
代入常系数齐次线性微分方程，方程化为$\left(r^{2}+p r+q\right) e^{r x}=0$
由于$\mathbf{e}^{r x} \neq 0$，方程化为**特征方程**$r^{2}+p r+q=0$，**如果特征方程有解，$y=\mathrm{e}^{r x}$代入原方程$y^{\prime \prime}+p y^{\prime}+q y=0$有解**。

关于r的特征方程$r^{2}+p r+q=0$是1元2次方程，它的两个根为$r_{1,2}=\frac{-p \pm \sqrt{p^{2}-4 q}}{2}$，
**特征方程的根分为3种情况**：
1）$p^{2}-4 q>0$时，特征方程有两个不相等的实根$r_{1}=\frac{-p+\sqrt{p^{2}-4 q}}{2}, \quad r_{2}=\frac{-p-\sqrt{p^{2}-4 q}}{2}$
2） $p^{2}-4 q=0$ 时，特征方程有两个相等的的实根（二重实根）$r_{1}=r_{2}=-\frac{p}{2}$
3）$p^{2}-4 q<0$ 时，特征方程有一对共轭复根（一对单重.复根）$r_{1}=\alpha+\beta i, \quad r_{2}=\alpha-\beta i$，其中$\alpha=-\frac{p}{2}, \quad \beta=\frac{\sqrt{4 q-p^{2}}}{2}$

与**特征方程**$r^{2}+p r+q=0$根可能有：两个不相等实根、二重实根、单重复根 三种情况**对应**，**常系数齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的解也分3种情况讨论**：
1）**特征方程有两个不相等实根$r_{1} \neq r_{2}$时**，$y_{1}=\mathrm{e}^{r_{1} x}, y_{2}=\mathrm{e}^{r_{2} x}$是微分方程的两个解，又$y_1,y_2$线性无关（$\frac{y_1}{y_2}$不是常数），即$y_1,y_2$是常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$线性无关的两个特解，得通解为$y=C_{1} \mathrm{e}^{r_{1} x}+C_{2} \mathrm{e}^{r_{2} x}$
2）**特征方程有两个相等实根（二重实根）$r_{1}=r_{2}$时**，得到微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的一个解$y_{1}=e^{r_{1} x}$。为了求此微分方程的通解，还需要求出另一个与$y_1$线性无关的解$y_2$。另一个解$y_2$可以用[常数变易法](#已知齐次的一个特解，求解二阶非齐次线性微分方程：常数变易法)求出：设$y_{2}=\mathrm{e}^{r_{1}^{x}} u(x)$，代入微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$有解，解出$u=C x$,不妨取$u=x$,则微分方程的另个一个解$y_{2}=x \mathrm{e}^{r_{1} x}$。
于是我们得到特征方程有两个相等实根（二重实根）时，常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的通解$y=C_{1} \mathrm{e}^{r_{1} x}+C_{2} x \mathrm{e}^{r_{1} x}$
3）**特征方程有一对共轭复根（单重复根）时**，常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的两个解为$y_{1}=\mathrm{e}^{(\alpha+\beta i) x}=\mathrm{e}^{\alpha x} \cdot \mathrm{e}^{\beta x \mathrm{i}}=\mathrm{e}^{\alpha x}(\cos \beta x+\mathrm{i} \sin \beta x)$
$y_{2}=\mathrm{e}^{(\alpha-\beta \mathrm{i}) x}=\mathrm{e}^{\alpha x} \cdot \mathrm{e}^{-\beta x \mathrm{i}}=\mathrm{e}^{\alpha x}(\cos \beta x-\mathrm{i} \sin \beta x)$
显然它们是线性无关的，直接用这两个根构造的通解也可以，但是可以构造更简洁的通解形式：
由齐次线性微分方程的叠加原理知，特解$y_1,y_2$的线性叠加也是方程的特解。
那么如下取共轭根的实部、虚部，也是方程的特解：
$\bar{y}_{1}=\frac{1}{2}\left(y_{1}+y_{2}\right)=\mathrm{e}^{\alpha x} \cos \beta x$
$\bar{y}_{2}=\frac{1}{2 \mathrm{i}}\left(y_{1}-y_{2}\right)=\mathrm{e}^{\alpha x} \sin \beta x$
它们是线性无关的（比值不是常数），所以，常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的通解为$y=e^{a x}\left(C_{1} \cos \beta x+C_{2} \sin \beta x\right)$。

**综上，则$y=\mathrm{e}^{r x}$就是常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的解。通过对常系数齐次微分方程（关于r）的特征方程$r^{2}+p r+q=0$根的讨论，可以得到二阶常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的通解。**

在此（推导证明的）基础上，可以得到，**求解二阶常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的通解的（简化/固定）步骤**：
1）写出$y^{\prime \prime}+p y^{\prime}+q y=0$的特征方程$r^{2}+p r+q=0$
2）求出特征方程的两个根$r_1,r_2$
3）根据特征方程根的不同情况（总结到了下面的表格中），写出$y^{\prime \prime}+p y^{\prime}+q y=0$的通解

| 特征方程$r^{2}+p r+q=0$的两个根$r_1,r_2$                     | 二阶常系数齐次微分方程$y^{\prime \prime}+p y^{\prime}+q y=0$的通解 |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 特征方程有两个不相等实根$r_{1} \neq r_{2}$时                 | $y=C_{1} \mathrm{e}^{r_{1} x}+C_{2} \mathrm{e}^{r_{2} x}$    |
| 特征方程有两个相等实根（二重实根）$r_{1}=r_{2}$时            | $y=\left(C_{1}+C_{2} x\right) \mathrm{e}^{r_{1} x}$          |
| 特征方程有一对共轭复根（单重.复根）$r_{1,2}=\alpha \pm \beta i$时 | $y=e^{\alpha x}\left(C_{1} \cos \beta x+C_{2} \sin \beta x\right)$ |

##### n阶常系数齐次线性微分方程的求解：特征方程法

n阶常系数齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=0$，其中 $p_{1}, p_{2}, \cdots, p_{n-1}, p_{n}$ 都是常数.

我们用记号D表示微分算子，即表示对 $x$ 求导的运算$\frac{d}{d x}$，把 $\frac{\mathrm{d} y}{\mathrm{d} x}$ 记作 $\mathrm{D} y$，把 $\frac{\mathrm{d}^{n} y}{\mathrm{d} x^{n}}$ 记作 $\mathrm{D}^{n} y$，

则$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=0$，
可以记作$\left(D^{n}+p_{1} D^{n-1}+\cdots+p_{n-1} D+p_{n}\right) y=0$
进一步，n阶常系数齐次线性微分方程可以记作$L(\mathrm{D}) y=0$

这里取微分算子表达式$L(\mathrm{D})=\mathrm{D}^{n}+p_{1} \mathrm{D}^{n-1}+\cdots+p_{n-1} \mathrm{D}+p_{n}$，这是一个关于微分算子D的n次表达式。



类比二阶时的求解，我们考虑$y=e^{rx}$作为$L(\mathrm{D}) y=0$的解。如果存在r使方程成立，则$y=e^{rx}$就是方程的解。

将$y=e^{rx}$代入$L(\mathrm{D}) y=0$。
由于 $ \mathrm{De}^{r x}=r \mathrm{e}^{r x}, \cdots ,D^{n} e^{r x}=r^{n} e^{r x}$，所以$L(\mathrm{D}) \mathrm{e}^{r x}=L(r) \mathrm{e}^{r x}$
所以方程化为$L(r) \mathrm{e}^{r x}=0$，
进一步，方程化为r的特征方程$L(r)=0,$ 即$r^{n}+p_{1} r^{n-1}+p_{2} r^{n-2}+\cdots+p_{n-1} r+p_{n}=0$。

这样，如果r是特征方程$r^{n}+p_{1} r^{n-1}+p_{2} r^{n-2}+\cdots+p_{n-1} r+p_{n}=0$的一个根，则函数$y=e^{rx}$就是n阶常系数齐次线性微分方程$L(\mathrm{D}) y=0$的一个解。

类比二阶时候的情况，根据特征方程的根的不同情况，可以得到$y=e^{rx}$和其他的根在微分方程通解中的项

| 特征方程的根                                      | n阶常系数齐次微分方程通解中的对应项                          |
| ------------------------------------------------- | ------------------------------------------------------------ |
| 特征方程存在单实根r                               | 微分方程通解中存在一项$C \mathrm{e}^{r x}$                   |
| 特征方程存在k重实根r                              | 微分方程通解中存在k项：$\mathrm{e}^{r_{1}}\left(C_{1}+C_{2} x+\cdots+C_{k} x^{k-1}\right)$ |
| 特征方程中存在单复根$r_{1,2}=\alpha \pm \beta i$  | 微分方程通解中存在一项$\mathrm{e}^{\alpha x}\left(C_{1} \cos \beta x+C_{2} \sin \beta x\right)$ |
| 特征方程中存在k重复根$r_{1,2}=\alpha \pm \beta i$ | 微分方程通解中存在2k项$\mathrm{e}^{\alpha x}\left[\left(C_{1}+C_{2} x+\cdots+C_{k} x^{k-1}\right) \cos \beta x+\left(D_{1}+D_{2} x+\cdots+D_{k} x^{k-1}\right) \sin \beta x\right]$ |

从代数学知道,n 次代数方程有 n 个根(重根按重数计算)，
而特征方程的每一个根都对应着通解中的一项,且每项各含一个任意常数,这样就得到 n 阶常系 数齐次线性微分方程的通解$y=C_{1} y_{1}+C_{2} y_{2}+\cdots+C_{n} y_{n}$

#### 常系数非齐次线性微分方程的求解：常数变易法、待定系数法

n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=f(x)$，其中 $p_{1}, p_{2}, \cdots, p_{n-1}, p_{n}$ 都是常数.

这里以二阶常系数非齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=f(x)$讨论，对于n阶的，也适用

根据非齐次线性微分方程解的结构，常系数非齐次线性微分方程的求解需要先求出对应齐次方程的通解，然后找一个特解即可。找特解有两种方法：常数变易法和待定系数法。

##### 解常系数非齐次线性微分方程：常数变易法

**常数变易法**（对于线性微分方程都可用），该方法利用对应的常系数齐次线性微分方程的解，将其中的常数换为几个未知函数，然后作为非齐次的解，代入非齐次方程求出这几个未知函数，从而求出非齐次方程的解。

**常数变易法**的问题是**需要积分，不一定能解得出来**。

（参见[常数变易法求解非齐次线性微分方程](#非齐次线性微分方程的求解（已知齐次通解）：常数变易法)，这里不多做赘述）

##### 解常系数非齐次线性微分方程：待定系数法

**待定系数法**只可以求解常系数非齐次线性微分方程的两类特例：方程右端自由项为$f(x)=\mathrm{e}^{\lambda x} P_{m}(x)$型、$f(x)=\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$型。**待定系数法只能求解这两类特例**，但不需要求积分。

###### 解二阶常系数非齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x} P_{m}(x)$型

$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x} P_{m}(x)$，其中$P_{m}(x)$ 是 $x$ 的一个 $m$ 次多项式：$P_{m}(x)=a_{0} x^{m}+a_{1} x^{m-1}+\cdots+a_{m-1} x+a_{m}$

$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x} P_{m}(x)$方程右端的自由项$\mathrm{e}^{\lambda x} P_{m}(x)$是指数函数和多项式函数的乘积，
而注意到指数函数和多项式函数的乘积的**导数**，仍然是指数函数和多项式函数的乘积

那么我们可以**推测**方程的一个特解为$y^{*}=R(x) \mathrm{e}^{\lambda x}$，（其中$R(x)$是x的多项式），又
$y^{*}=R(x) \mathrm{e}^{\lambda x}$
$y^{*}=\mathrm{e}^{\lambda x}\left[\lambda R(x)+R^{\prime}(x)\right]$
$y^{*}=\mathrm{e}^{\lambda x}\left[\lambda^{2} R(x)+2 \lambda R^{\prime}(x)+R^{\prime \prime}(x)\right]$
代入方程并消去$\mathrm{e}^{\lambda x}$，方程化为：
$R^{\prime \prime}(x)+(2 \lambda+p) R^{\prime}(x)+\left(\lambda^{2}+p \lambda+q\right) R(x)=P_{m}(x)$
方程两端都是x的多项式，两边多项式的系数应该都相等，比较可以得到最初$R(x)$的各项系数，这就是**待定系数法**。

不过变换后的多项式方程$R(x)$和$R \prime (x)$项可能不存在，需要讨论一下：
1）若$\lambda^{2}+p \lambda+q \neq 0$（即参数$\lambda$不是特征方程$\lambda^{2}+p \lambda+q=0$的根），则$R(x)$应为m次多项式，可设$R(x) = R_{m}(x)=b_{0} x^{m}+b_{1} x^{m-1}+\cdots+b_{m-1} x+b_{m}$，代入原方程变换后的多项式方程即可确定各项系数。
2）若特征方程$\lambda^{2}+p \lambda+q=0$且$2 \lambda+p \neq 0$（即参数$\lambda$正好是特征方程的单根），原方程化为$R^{\prime \prime}(x)+(2 \lambda+p) R^{\prime}(x)=P_{m}(x)$，则$R(x)$应为(m+1)次多项式，可设$R(x)=x R_{m}(x)$，代入原方程变换后的多项式方程即可确定各项系数。
3）若特征方程$\lambda^{2}+p \lambda+q=0$且$2 \lambda+p = 0$（即参数$\lambda$正好是特征方程的二重根），则$R(x)$应为(m+2)次多项式，可设$R(x)=x^2 R_{m}(x)$，代入原方程变换后的多项式方程即可确定各项系数。

**综上**，对于二阶的$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x} P_{m}(x)$型常系数非齐次线性微分方程，其特解具有如下形式$y^{*}=x^{k} R_{m}(x) \mathrm{e}^{\lambda x}$ 
（当参数$\lambda$分别 不是特征方程$\lambda^{2}+p \lambda+q=0$的根、是特征方程的的单根、是特征方程的二重根时， 分别有$k=0,1,2$）
（$R_{m}(x)$ 是与 $P_{m}(x)$ 同次（ $m$ 次 ) 的多项式）

###### 解n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=\mathrm{e}^{\lambda x} P_{m}(x)$型

由二阶，很容易推广到n阶，结论如下：

对于n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=\mathrm{e}^{\lambda x} P_{m}(x)$型，其特解具有如下形式$y^{*}=x^{k} R_{m}(x) \mathrm{e}^{\lambda x}$ 
（当参数$\lambda$分别 不是特征方程$\lambda^{n}+p_1 \lambda^{n-1}+... +q=0$的根、是特征方程的s重根时， 分别有$k=0$和$k=s$）
（$R_{m}(x)$ 是与 $P_{m}(x)$ 同次（ $m$ 次 ) 的多项式）

###### 解二阶常系数非齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$型

应用[欧拉公式](#附：欧拉公式)有$\mathrm{e}^{i \theta}=\cos \theta +i \sin \theta)$，有$\cos \theta=\frac{1}{2}\left(\mathrm{e}^{i \theta}+\mathrm{e}^{-\mathrm{i} \theta}\right), \sin \theta=\frac{1}{2 \mathrm{i}}\left(\mathrm{e}^{i \theta}-\mathrm{e}^{-i \theta}\right)$
则非齐次方程右端自由项可以写成
$\begin{aligned} f(x) &=\mathrm{e}^{\lambda x}\left[P_{l} \cos \omega x+Q_{n} \sin \omega x\right] \\ &=\mathrm{e}^{\lambda x}\left[P_{l} \frac{\mathrm{e}^{\omega \mathrm{x}}+\mathrm{e}^{-\omega \mathrm{z} i}}{2}+Q_{n} \frac{\mathrm{e}^{\omega \mathrm{xi}}-\mathrm{e}^{-\omega \mathrm{xi}}}{2 \mathrm{i}}\right] \\ &=\left(\frac{P_{l}}{2}+\frac{Q_{n}}{2 \mathrm{i}}\right) \mathrm{e}^{(\lambda+\omega \mathrm{i}) x}+\left(\frac{P_{l}}{2}-\frac{Q_{n}}{2 \mathrm{i}}\right) \mathrm{e}^{(\lambda-\mathrm{oi}) x} \\ &=P(x) \mathrm{e}^{(\lambda+\omega \mathrm{i}) x}+\bar{P}(x) \mathrm{e}^{(\lambda-\omega i) x} \end{aligned}$
其中$P(x)=\frac{P_{t}}{2}+\frac{Q_{n}}{2 \mathrm{i}}=\frac{P_{t}}{2}-\frac{Q_{n}}{2} \mathrm{i}, \bar{P}(x)=\frac{P_{l}}{2}-\frac{Q_{n}}{2 \mathrm{i}}=\frac{P_{l}}{2}+\frac{Q_{n}}{2} \mathrm{i}$，互共轭。
由非齐次线性微分方程的叠加定理可知，原方程的特解可以看作是$y^{\prime \prime}+p y^{\prime}+q y=P(x) \mathrm{e}^{(\lambda+\omega \mathrm{i}) x}$和$y^{\prime \prime}+p y^{\prime}+q y=\bar{P}(x) \mathrm{e}^{(\lambda-\omega i) x} $特解的叠加。
而后面两个方程，都是可以用[上一目](#解二阶常系数非齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x} P_{m}(x)$型)待定系数法求解的，
从而可**设原方程的特解**为$y^{*}=x^{k} R_{m} \mathrm{e}^{(\lambda+\omega i) x}+x^{k} \bar{R}_{m} \mathrm{e}^{(\lambda-\omega i) x}$
(这里$R_m(x)$是推广到复数域的多项式)
(其中$m=\max \{l, n\}$，是原方程右端自由项$\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$中多项式得最高次)
($k$ 按 $\lambda+\omega i$ 不是特征方程的根或是特征方程的单根依次取 0 或 1)
特解$\begin{aligned} y^{*} &=x^{k} \mathrm{e}^{\lambda x}\left[R_{m} \mathrm{e}^{\omega x \mathrm{i}}+\bar{R}_{m} \mathrm{e}^{-\omega \mathrm{xi}}\right] \\ &=x^{k} \mathrm{e}^{\lambda x}\left[R_{m}(\cos \omega x+\mathrm{i} \sin \omega x)+\bar{R}_{m}(\cos \omega x-\mathrm{i} \sin \omega x)\right] \end{aligned}$
中括号内两项是共轭得，相加后无虚部，原方程特解可以写成实函数：
$y^{*}=x^{k} \mathrm{e}^{\lambda x}\left[R_{m}^{(1)}(x) \cos \omega x+R_{m}^{(2)}(x) \sin \omega x\right]$
(把$R_{m}^{(1)}(x)$和$R_{m}^{(2)}(x)$分别各看作一个m次多项式)

综上，对于二阶常系数非齐次线性微分方程$y^{\prime \prime}+p y^{\prime}+q y=\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$型，其特解具有如下形式（可**设原方程的特解**为）
$y^{*}=x^{k} \mathrm{e}^{\lambda x}\left[R_{m}^{(1)}(x) \cos \omega x+R_{m}^{(2)}(x) \sin \omega x\right]$
(其中$m=\max \{l, n\}$，是原方程右端自由项$\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$中多项式得最高次)
($k$ 按 $\lambda+\omega i$ 不是特征方程的根或是特征方程的单根依次取 0 或 1)
($R_{m}^{(1)}(x)$和$R_{m}^{(2)}(x)$分别是一个m次多项式)

###### 解n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$型

二阶很容易推广到n阶，对于n阶常系数非齐次线性微分方程$y^{(n)}+p_{1} y^{(n-1)}+p_{2} y^{(n-2)}+\cdots+p_{n-1} y^{\prime}+p_{n} y=\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$型，其特解具有如下形式
$y^{*}=x^{k} \mathrm{e}^{\lambda x}\left[R_{m}^{(1)}(x) \cos \omega x+R_{m}^{(2)}(x) \sin \omega x\right]$
(其中$m=\max \{l, n\}$，是原方程右端自由项$\mathrm{e}^{\lambda x}\left[P_{l}(x) \cos \omega x+Q_{n}(x) \sin \omega x\right]$中多项式得最高次)
($k$ 按 $\lambda+\omega i$ 不是特征方程的根，或是特征方程的s重根依次取 0 或 s)
($R_{m}^{(1)}(x)$和$R_{m}^{(2)}(x)$分别是一个m次多项式)

### 常系数线性微分方程组的求解

参考：高等数学同济第七版（上）

前面都是讨论一个微分方程确定一个（单自变量）未知函数的问题，
实际问题中，还会遇到几个微分方程组联立确定（一个自由元的）多个未知函数的问题，这些联立的微分方程称**微分方程组**

如果微分方程组中的每一个微分方程都是常系数线性微分方程，那么这个微分方程组就叫做**常系数线性微分方程组**

如果微分方程组是常系数线性微分方程组，且最终只有一个自由元，这种方程组是可解的。

常系数线性微分方程组（一自由元）的**求解步骤**：
1）从方程组中消去一些未知函数及其各阶导数,得到只含有一个未知函数的高阶常系数线性微分方程. （消元）
2）解此高阶微分方程,求出满足该方程的未知函数. 
3）把已求得的函数代人原方程组，一般说来,不必经过积分就可求出其余的未知函数.

注：用记号 D 表示 $\frac{\mathrm{d}}{\mathrm{d} t}$（这里t是自由元），又常系数线性微分微分方程组是线性的，
可以使用线性代数解方程组的方法来求解

## 非线性微分方程

一般的非线性微分方程都是解不出来的，而有几种非线性方程却可以通过变量代换，变成可解的线性微分方程

### 解伯努利方程

伯努利方程：$\frac{\mathrm{d} y}{\mathrm{d} x}+P(x) y=Q(x) y^{n} \quad(n \neq 0,1)$

[伯努利方程的变量代换与求解](#伯努利方程)，前面已有介绍，这里不多做赘述。

### 解欧拉方程

**欧拉方程**：$x^{n} y^{(n)}+p_{1} x^{n-1} y^{(n-1)}+\cdots+p_{n-1} x y^{\prime}+p_{n} y=f(x)$，其中$p_{1}, p_{2}, \cdots, p_{n}$ 为常数。

欧拉方程是一种特殊的[变系数线性微分方程](#n阶线性微分方程)
（n阶线性微分方程：$y^{(n)}+a_{1}(x) y^{(n-1)}+\cdots+a_{n-1}(x) y^{\prime}+a_{n}(x) y=f(x)$）

**变量代换**：作变换 $x=\mathrm{e}^{t}$ 或 $t=\ln x,$ 将自变量 $x$ 换成 $t$。

则有：
$\frac{\mathrm{d} y}{\mathrm{d} x}=\frac{\mathrm{d} y}{\mathrm{d} t} \cdot \frac{\mathrm{d} t}{\mathrm{d} x}=\frac{1 \mathrm{d} y}{x \mathrm{d} t}$
$\frac{\mathrm{d}^{2} y}{\mathrm{d} x^{2}}=\frac{1}{x^{2}}\left(\frac{\mathrm{d}^{2} y}{\mathrm{d} t^{2}}-\frac{\mathrm{d} y}{\mathrm{d} t}\right)$
$\frac{\mathrm{d}^{3} y}{\mathrm{d} x^{3}}=\frac{1}{x^{3}}\left(\frac{\mathrm{d}^{3} y}{\mathrm{d} t^{3}}-3 \frac{\mathrm{d}^{2} y}{\mathrm{d} t^{2}}+2 \frac{\mathrm{d} y}{\mathrm{d} t}\right)$

取记号 D 表示对 $t$ 求导的运算$\frac{\mathrm{d}}{\mathrm{d} t}$，并依据上述计算，有：
$x y^{\prime}=D y$
$x^{2} y^{\prime \prime}=\frac{\mathrm{d}^{2} y}{\mathrm{d} t^{2}}-\frac{\mathrm{d} y}{\mathrm{d} t}=\left(\frac{\mathrm{d}^{2}}{\mathrm{d} t^{2}}-\frac{\mathrm{d}}{\mathrm{d} t}\right) y=\left(\mathrm{D}^{2}-\mathrm{D}\right) y=\mathrm{D}(\mathrm{D}-1) y$
$x^{3} y^{\prime \prime \prime}=\frac{\mathrm{d}^{3} y}{\mathrm{d} t^{3}}-3 \frac{\mathrm{d}^{2} y}{\mathrm{d} t^{2}}+2 \frac{\mathrm{d} y}{\mathrm{d} t}=\left(\mathrm{D}^{3}-3 \mathrm{D}^{2}+2 \mathrm{D}\right) y=\mathrm{D}(\mathrm{D}-1)(\mathrm{D}-2) y$

一般的，有：
$x^{k} y^{(k)}=D(D-1) \cdots(D-k+1) y$

将上述各项$x^{k} y^{(k)}=D(D-1) \cdots(D-k+1) y$ 代入欧拉方程，则原方程变为以 $t$ 为自变量的常系数线性微分方程。
解出这个方程后，把 $t$ 换成 In $x,$ 即得原欧拉方程的解。

## 附：欧拉公式

欧拉公式$\mathrm{e}^{(a+b i) x}=\mathrm{e}^{a x}(\cos b x+i \sin b x)$

或者有$\mathrm{e}^{i \theta}=\cos \theta +i \sin \theta$，

有$\cos \theta=\frac{1}{2}\left(\mathrm{e}^{i \theta}+\mathrm{e}^{-\mathrm{i} \theta}\right), \sin \theta=\frac{1}{2 \mathrm{i}}\left(\mathrm{e}^{i \theta}-\mathrm{e}^{-i \theta}\right)$

## 附：齐次的辨析

注：微分方程中有两个地方用到“齐次”的叫法：”齐次方程“，”齐次线性方程“，这里的齐次意义是不同的，注意辨析：[百度百科：齐次方程](https://baike.baidu.com/item/齐次方程)“齐次”从词面上解释是“次数相等”的意思。

**微分方程中有两个地方用到“齐次”的叫法**：

1、形如

![img](https://bkimg.cdn.bcebos.com/formula/e20147f1a3eef408d3de4a7cd8ac956f.svg)

的方程称为“齐次方程”，这里是**指方程中每一项关于x、y的次数都是相等**的，例如

![img](https://bkimg.cdn.bcebos.com/formula/1cfee93f41788e9f2335dc77735d3b29.svg)

都算是二次项，而

![img](https://bkimg.cdn.bcebos.com/formula/81156cce131efa267ddb3c7d8f015407.svg)

算0次项，方程

![img](https://bkimg.cdn.bcebos.com/formula/3f9a0692b78ce6aa0d18d51188bccac8.svg)

中每一项都是0次项，所以是“齐次方程”。

2、形如y''+py'+qy=0的方程称为“齐次线性方程”，**这里“齐次”是指方程中每一项关于未知函数y及其导数y'，y''，……的次数都是相等的（都是一次），方程中没有自由项（不包含y及其导数的项）**，“线性”则表示导数之间是线性运算（简单地说就是各阶导数之间的只能加减），比如方程y''+py'+qy=x就不是“齐次”的,因为方程右边的项x不含y及y的导数，是关于y,y',y'',……的0次项，因而就要称为“非齐次线性方程”，方程yy'=1也不是，因为它首先不是线性的。

另外**在[线性代数](https://baike.baidu.com/item/线性代数/800)里也有“齐次”的叫法**，例如

![img](https://bkimg.cdn.bcebos.com/formula/41d244eb9c7fce7c5f48a0fc1057052d.svg)

称为二次齐式，即二次齐次式的意思，因为f中每一项都是关于x、y的二次项。

## 附2：线性相关与线性无关

设 $y_{1}(x), y_{2}(x), \cdots, y_{n}(x)$ 为定义在区间 $I$ 上的 $n$ 个函数,
如果存在 $n$ 个不 全为零的常数 $k_{1}, k_{2}, \cdots, k_{n},$ 
使得当 $x \in I$ 时有恒等式$k_{1} y_{1}+k_{2} y_{2}+\cdots+k_{n} y_{n} \equiv 0$成立，称这n个函数在区间I上**线性相关**，否则称**线性无关**

注：线性代数也由线性相关、线性无关的介绍。



